<div class="global-search-container">
  <div class="global-search">
    <mat-icon class="search-icon">search</mat-icon>

    <input type="text" class="search-input" placeholder="Search by File Number, File Name, ID Number or Cell Number" [(ngModel)]="globalSearchValue" />

    <button class="search-btn" (click)="onGlobalSearch()">Search</button>
  </div>
</div>

<mat-accordion multi="true">
  <!-- MY TODO LIST (OPEN BY DEFAULT) -->
  <mat-expansion-panel [expanded]="true">
    <mat-expansion-panel-header>
      <mat-panel-title> My To-Do List ({{ todos.length }}) </mat-panel-title>
    </mat-expansion-panel-header>

    <table class="clientflow-table todo-table">
      <thead>
        <tr>
          <th class="col-checkbox">
            <mat-checkbox></mat-checkbox>
          </th>
          <th class="col-no">No</th>
          <th class="col-urgent">Urgent</th>
          <th class="col-requested">Requested by</th>
          <th class="col-file">File no</th>
          <th class="col-client">Client</th>
          <th class="col-agent">Agent</th>
          <th class="col-description">Description</th>
          <th class="col-age">File age</th>
          <th class="col-phoned">Phoned</th>
          <th class="col-flag">Flag</th>
          <th class="col-edit">Edit</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let todo of todos; let i = index" [class.urgent-row]="todo.urgent">
          <td class="col-checkbox">
            <mat-checkbox [(ngModel)]="todo.selected"></mat-checkbox>
          </td>

          <td class="col-no">{{ i + 1 }}</td>

          <td class="col-urgent urgent-date">
            {{ todo.urgentDate }}
          </td>

          <td class="col-requested">{{ todo.requestedBy }}</td>
          <td class="col-file link">{{ todo.fileNo }}</td>
          <td class="col-client link">{{ todo.clientName }}</td>
          <td class="col-agent link">{{ todo.agent }}</td>

          <td class="col-description">
            {{ todo.description }}
          </td>

          <td class="col-age">{{ todo.fileAgeDays }} days</td>
          <td class="col-phoned">{{ todo.phonedDays }} days</td>

          <td class="col-flag">üö©</td>
          <td class="col-edit">‚úèÔ∏è</td>
        </tr>
      </tbody>
    </table>
  </mat-expansion-panel>

  <mat-expansion-panel>
    <mat-expansion-panel-header>
      <mat-panel-title> Files in Take-On ({{ takeOnFiles.length }}) </mat-panel-title>
    </mat-expansion-panel-header>

    <table class="clientflow-table">
      <thead>
        <tr>
          <th>File no</th>
          <th>
            Initiated on
            <span class="sort-arrow">‚Üë</span>
          </th>
          <th>Client</th>
          <th>ID Number</th>
          <th>Edit</th>
          <th>Delete</th>
        </tr>
      </thead>

      <tbody>
        <!-- EMPTY STATE -->
        <tr *ngIf="takeOnFiles.length === 0">
          <td colspan="6" class="empty-state">No entries to display</td>
        </tr>

        <!-- FUTURE DATA -->
        <tr *ngFor="let file of takeOnFiles">
          <td class="link">{{ file.fileNo }}</td>
          <td>{{ file.initiatedOn }}</td>
          <td>{{ file.clientName }}</td>
          <td>{{ file.idNumber }}</td>
          <td>‚úèÔ∏è</td>
          <td *ngIf="canDelete()">üóëÔ∏è</td>
        </tr>
      </tbody>
    </table>
  </mat-expansion-panel>

  <mat-expansion-panel>
    <mat-expansion-panel-header>
      <mat-panel-title> My Lists ({{ myLists.length }}) </mat-panel-title>

      <span class="spacer"></span>

      <!-- <button
      mat-stroked-button
      color="primary"
      class="add-list-btn">
      Add List
    </button> -->
    </mat-expansion-panel-header>

    <table class="clientflow-table">
      <thead>
        <tr>
          <th>
            List Name
            <span class="sort-arrow">‚Üë</span>
          </th>
          <th>Description</th>
          <th>List Owner</th>
          <th>Type</th>
          <th>Edit List</th>
          <th>Copy List</th>
          <th>Delete</th>
        </tr>
      </thead>

      <tbody>
        <!-- EMPTY STATE -->
        <tr *ngIf="myLists.length === 0">
          <td colspan="7" class="empty-state">No entries to display</td>
        </tr>

        <!-- DATA -->
        <tr *ngFor="let list of myLists">
          <td class="link">{{ list.name }}</td>
          <td>{{ list.description }}</td>
          <td>{{ list.owner }}</td>
          <td>{{ list.type }}</td>
          <td class="icon-cell">‚úèÔ∏è</td>
          <td class="icon-cell">üìÑ</td>
          <td class="icon-cell">üóëÔ∏è</td>
        </tr>
      </tbody>
    </table>
  </mat-expansion-panel>

  <!-- FILES WAITING FOR VERIFICATION -->
  <mat-expansion-panel>
    <mat-expansion-panel-header>
      <mat-panel-title> FL Files waiting to be verified ({{ flFilesWaitingVerification.length }}) </mat-panel-title>
    </mat-expansion-panel-header>

    <table class="clientflow-table verify-table">
      <!-- COLUMN LOCK (MOST IMPORTANT PART) -->
      <colgroup>
        <col class="col-file" />
        <col class="col-name" />
        <col class="col-registr" />
        <col class="col-do" />
        <col class="col-id" />
        <col class="col-agent" />
        <col class="col-company" />
        <col class="col-v" />
        <col class="col-v" />
        <col class="col-status" />
      </colgroup>

      <thead>
        <tr>
          <th class="col-file">File no</th>
          <th class="col-name">Name</th>
          <th class="col-registr">Registr <span class="sort-arrow">‚Üë</span></th>
          <th class="col-do">D/O</th>
          <th class="col-id">ID No</th>
          <th class="col-agent">Agent</th>
          <th class="col-company">Company</th>
          <th class="col-v">V Details</th>
          <th class="col-v">V Pmts</th>
          <th class="col-status"></th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let file of flFilesWaitingVerification">
          <td class="col-file link">{{ file.fileNo }}</td>
          <td class="col-name link">{{ file.name }}</td>
          <td class="col-registr">{{ file.registeredOn }}</td>
          <td class="col-do">{{ file.do }}</td>
          <td class="col-id">{{ file.idNo }}</td>
          <td class="col-agent">{{ file.agent }}</td>
          <td class="col-company">{{ file.company }}</td>
          <td class="col-v link">V Details</td>
          <td class="col-v link">V Pmts</td>

          <td class="col-status">
            <span *ngIf="file.status === 'APPROVED'" class="status approved" title="Verified"> ‚úî </span>

            <span *ngIf="file.status === 'REJECTED'" class="status rejected" title="Rejected"> ‚úñ </span>

            <span *ngIf="file.status === 'PENDING'" class="status pending" title="Pending"> ‚è≥ </span>
          </td>
        </tr>
      </tbody>
    </table>
  </mat-expansion-panel>
</mat-accordion>
